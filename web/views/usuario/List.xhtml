<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <body>

        <ui:composition template="./../../WEB-INF/siipgTemplate.xhtml">


            <ui:define name="content">

                <div class="ui-g" style="padding-top:20px; ">
                    <div class="ui-g-1"></div>
                    <div class="ui-g-10" style="border:2px solid black; border-radius: 5px; background-color:rgba(0,0,255,.05);">
                        <div style="color: #045491; font-size: 120%;font-weight: bold;"><center>Usuarios del Sistema</center><hr></hr></div> 
                        <div class="ui-g" >

                            <div class="ui-g-3" >
                                <h:form>
                                    <h:panelGrid columns="2">
                                        <p:button value="Buscar" />
                                        <p:inputText />
                                    </h:panelGrid>
                                </h:form>
                            </div>    
                            <div class="ui-g-7"></div>    
                            <div class="ui-g-2">
                                <h:form>
                                    &nbsp; &nbsp; &nbsp; 
                                    <h:commandLink >
                                        <h:graphicImage library="images" name="pdf.png" />
                                    </h:commandLink>&nbsp; &nbsp; 
                                    <h:commandLink action="#{userController.prepareCreate()}">
                                        <h:graphicImage library="images" name="add.png" />
                                    </h:commandLink>
                                </h:form>
                            </div>                            
                        </div>
                        <h:form id="showUsersForm">

                            <p:dataTable id="usersTable" value="#{userController.items}" var="user" style="text-align: center; border-collapse: collapse; margin-bottom: 20px;"
                                         paginator="true" rows="20"  paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         rowsPerPageTemplate="10,20,30" currentPageReportTemplate="P치gina ({currentPage} de {totalPages})">
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Nombre"/>
                                    </f:facet>
                                    <h:outputText value="#{user.nombre } #{user.apellidoPaterno } #{user.apellidoMaterno }"/>
                                </p:column>

                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="RFC"/>
                                    </f:facet>
                                    <h:outputText value="#{user.rfc}"/>
                                </p:column>
                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Privilegio"/>
                                    </f:facet>
                                    <h:outputText value="#{user.rol.nombre}"/>
                                </p:column>

                                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="Estatus"/>
                                    </f:facet>
                                    <h:outputLabel value="#{user.status==0? 'No vigente' : 'Vigente'}"/>
                                </p:column>

                                <p:column headerText="Eliminar" style="width: 65px;"> 
                                    <p:commandLink type="button" oncomplete="PF('dlgEliminar').show();" >
                                        <f:setPropertyActionListener target="#{userController.current}" value="#{user}"/>
                                        <h:graphicImage library="images" name="delete.png" />
                                    </p:commandLink>
                                </p:column>  
                                <p:column headerText="Editar" style="width: 50px;">
                                    <p:commandLink type="button" action="#{userController.prepareEdit2()}" update="detalleForm" >
                                        <h:graphicImage library="images" name="note.png" />
                                        <f:setPropertyActionListener target="#{userController.current}" value="#{user}"/>
                                    </p:commandLink>
                                </p:column> 
                                <p:column headerText="Detalle" style="width: 50px;">
                                    <p:commandLink type="button" oncomplete="PF('dlgDetalles').show();" update="detalleForm">
                                        <h:graphicImage library="images" name="preview.png" />
                                        <f:setPropertyActionListener target="#{userController.current}" value="#{user}"/>
                                    </p:commandLink>
                                </p:column> 

                            </p:dataTable>

                        </h:form>


                    </div>
                    <div class="ui-g-1"></div>

                </div>
                <!-- Dialogo para confirmar la acci칩n de eliminar un registro. -->
                <h:form>
                    <p:dialog id="dlg2" header="Confirmar Acci칩n" widgetVar="dlgEliminar" modal="true" 
                              closeOnEscape="true"
                              resizable="false" 
                              showEffect="explode"
                              hideEffect="explode">
                        <h:outputText value="Desea eliminar este registro?  "/>
                        <br></br>
                        <br></br>
                        <center>
                            <p:commandButton value="Si" 
                                             actionListener="#{userController.deleteItem()}"
                                             update="showUsersForm:usersTable"
                                             oncomplete="PF('dlgEliminar').hide();"
                                             />
                            &nbsp; 
                            <p:commandButton value="No"
                                             onclick="PF('dlgEliminar').hide();"/>
                        </center>
                    </p:dialog>
                </h:form>
                <!-- Dialogo para mostrar el resumen detallado de un usuario. -->
                <h:form id="detalleForm">
                    <p:dialog id="dlgDetalle" header="Informaci칩n General" widgetVar="dlgDetalles" modal="true" 
                              closeOnEscape="true"
                              resizable="false" 
                              showEffect="explode"
                              hideEffect="explode">
                        <h:outputText value="Desea eliminar este registro?  "/>
                        <br></br>
                        <br></br>
                        <h:panelGrid columns="2" cellpadding="5">

                            <h:outputText value="Nombre:" style=" color: red; " />
                            <h:outputText value="#{userController.current.nombre}"  />                                    

                            <h:outputText value="Apellido Paterno:"   style="color: red;" />
                            <h:outputText value="#{userController.current.apellidoPaterno}"  /> 

                            <h:outputText value="Apellido Materno:"  style=" color: red;" />
                            <h:outputText value="#{userController.current.apellidoMaterno}"/>

                            <h:outputText value="RFC/Homoclave: "  style=" color: red;" />
                            <h:outputText value="#{userController.current.rfc}"  />

                            <h:outputText value="Email:"  style="color: red;" />
                            <h:outputText value="#{userController.current.email}" />

                            <h:outputText value="Telefonos:"  style=" color: red;" />
                            <h:outputText  value="#{userController.current.telefonos}"  />             

                            <h:outputText value="No. Empleado:"  style=" color: red;" />
                            <h:outputText value="#{userController.current.numeroEmpleado}"   />


                            <h:outputText value="Rol:"  style=" color: red;"  />
                            <h:outputText value="#{userController.selectedRol}"  />

                            <h:outputText value="Estatus:"  style=" color: red;" />
                            <h:outputText value="#{userController.current.status}"   />


                            <h:outputText value="Area"  style=" color: red;" />
                            <h:outputText value="Area Central"   />

                            <h:outputText value="Unidad Academica:"  style="color: red;" />
                            <h:outputText value="#{userController.selectedUnidad}"   />

                        </h:panelGrid>
                        <h:panelGrid columns="2" cellpadding="8" >


                            <p:commandButton value="Salir" onclick="PF('dlgDetalles').hide();"/>            
                        </h:panelGrid>
                    </p:dialog>
                </h:form>
            </ui:define>



        </ui:composition>

    </body>
</html>
